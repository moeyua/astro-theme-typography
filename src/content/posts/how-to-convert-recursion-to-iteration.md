---
title: å¦‚ä½•å°†é€’å½’è½¬æˆè¿­ä»£
pubDate: 2021-10-28 22:00 PST
categories: ["èŠèŠæŠ€æœ¯"]
tags: iteration, recursion, LeetCode, Python, è¿­ä»£, é€’å½’, ç®—æ³•
heroImage: /images/blog/stone-stack-scaled.jpeg
heroImageDescription: Photo by Sean Stratton on Unsplash
---

> è¦ç†è§£é€’å½’ï¼Œå…ˆå¾—ç†è§£é€’å½’

# å‘ç°é—®é¢˜

å‡½æ•°çš„é€’å½’è°ƒç”¨æ˜¯ç å†œåœ¨æ—¥å¸¸å·¥ä½œä¸­ä¸å¯æˆ–ç¼ºçš„åˆ©å™¨ï¼Œåœ¨æŸäº›é—®é¢˜ä¸Šï¼Œå‡½æ•°é€’å½’å¯ä»¥æä¾›æ›´ä¸ºç®€æ´çš„ä»£ç å®ç°å’Œæ›´ä¸ºç›´è§‚çš„é˜…è¯»ç†è§£ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬å¾ˆç†Ÿæ‚‰çš„æ ‘å½¢ç»“æ„çš„éå†ã€‚

ç„¶è€Œï¼Œå½“å‡½æ•°è°ƒç”¨çš„å±‚æ•°è¿‡å¤šçš„æ—¶å€™ï¼Œå°±å¯èƒ½å¯¼è‡´è‘—åçš„ [Stack Overflow](https://en.wikipedia.org/wiki/Stack_buffer_overflow) é”™è¯¯ï¼Œè€Œæ ˆç©ºé—´ä¸€èˆ¬æ˜¯ç”±ç¼–è¯‘å™¨ï¼ˆ C/C++ ç­‰ï¼‰æˆ–è€… Java è™šæ‹Ÿæœºï¼ˆ Java ç³»è¯­è¨€ï¼‰æ¥ç®¡ç†ï¼Œå¯¹ç¨‹åºå‘˜æ˜¯ä¸å¯è§çš„ï¼Œå½“ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®å‚æ•°æ¥è°ƒæ•´ç¨‹åºçš„æ ˆç©ºé—´å¤§å°ï¼Œä½†ä¸å…éº»çƒ¦ï¼Œå¹¶ä¸”é€’å½’å±‚æ•°ä¸€å¢åŠ ï¼Œæ ˆå¾ˆå¯èƒ½åˆè¦æº¢å‡ºã€‚

[å°¾é€’å½’](https://en.wikipedia.org/wiki/Tail_call)æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ä¼˜åŒ–æ–¹æ³•ï¼Œå¾ˆå¤šè¯­è¨€åœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šè¯†åˆ«è¿™ç§ä¼˜åŒ–ï¼Œå› ä¸ºé€’å½’å‡½æ•°è°ƒç”¨æ˜¯ä¸€ä¸ªå‡½æ•°çš„æœ€åä¸€æ­¥ï¼Œæ‰€ä»¥åœ¨é€’å½’è°ƒç”¨ä¹‹å‰ï¼Œå°±å¯ä»¥æŠŠå½“å‰å‡½æ•°è°ƒç”¨ä»æ ˆä¸­å¼¹å‡ºï¼Œå†æŠŠæ–°çš„å‡½æ•°è°ƒç”¨å‹æ ˆï¼Œè¿™æ ·å°±ä¸ä¼šå› ä¸ºé€’å½’æ·±åº¦çš„å¢åŠ åƒæ‰æ ˆç©ºé—´äº†ã€‚

ä½†å°¾é€’å½’å¹¶ä¸æ˜¯å¾ˆå®¹æ˜“å°±èƒ½å®ç°çš„ï¼Œç”¨äºŒå‰æ ‘çš„ä¸­åºéå†ä¸¾ä¾‹ï¼Œå®ƒçš„é€’å½’ç‰ˆæœ¬éå¸¸ç®€å•ç›´è§‚ï¼Œ

```python
# æ ‘èŠ‚ç‚¹çš„å®šä¹‰
class TreeNode:
    def __init__(self, val=0, left=None, right=None):
        self.val = val
        self.left = left
        self.right = right

def inorder_traversal(node):
    if node is None:
        return []
    left = inorder_traversal(node.left)
    right = inorder_traversal(node.right)
    return left + [node.val] + right
```

ä½†è¯•å›¾å°†å…¶è½¬æˆå°¾é€’å½’åˆ™éå¸¸éº»çƒ¦ï¼Œå› ä¸ºå®ƒåŒ…å«ä¸¤ä¸ªé€’å½’è°ƒç”¨ï¼Œå¹¶ä¸”ä¸¤ä¸ªé€’å½’è°ƒç”¨çš„ç»“æœåœ¨æœ€ç»ˆè¦æ‹¼æ¥åœ¨ä¸€èµ·è¿”å›ã€‚è¿™æ—¶å¦‚æœè¿˜æƒ³é¿å…æ ˆæº¢å‡ºçš„é—®é¢˜ï¼Œå°±éœ€è¦å°†å®ƒè½¬æˆè¿­ä»£çš„å½¢å¼ï¼Œä¹ä¸€å¬ä¹Ÿæ˜¯ä¸€ä¸ªä¸å¤ªå®¹æ˜“çš„å·¥ä½œï¼Œè™½ç„¶[æŸåˆ·é¢˜ç½‘ç«™](https://leetcode-cn.com/problems/binary-tree-inorder-traversal/solution/er-cha-shu-de-zhong-xu-bian-li-by-leetcode-solutio/)ç»™å‡ºäº†è¿­ä»£å½¢å¼çš„ä»£ç ï¼Œä½†æˆ‘ä¸ªäººè®¤ä¸ºè¿™ä¸ªç­”æ¡ˆå†™å¾—å¹¶ä¸æ˜“äºç†è§£ï¼Œè¯»å®Œä¹‹åä¸å…¶è¯´æ˜¯æˆ‘åœ¨å°è¯•ç†è§£è¿­ä»£çš„è¿‡ç¨‹ï¼Œå€’ä¸å¦‚è¯´æ˜¯åœ¨æ­»è®°ç¡¬èƒŒï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ›´ç›´æ¥çš„æ–¹å¼å°†é€’å½’ä»£ç è½¬æˆè¿­ä»£ä»£ç ã€‚

# è§£å†³é—®é¢˜

å‡½æ•°é€’å½’æœ¬è´¨ä¸Šæ˜¯å‡½æ•°è°ƒç”¨å…¥æ ˆå‡ºæ ˆçš„è¿‡ç¨‹ï¼Œå¹¶ä¸”åœ¨å…¶ä¸­éšå¼åœ°å«æœ‰æ¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„çŠ¶æ€ï¼Œå‡½æ•°é€šè¿‡æŸ¥çœ‹è¿™ä¸ªçŠ¶æ€æ¥å†³å®šæ˜¯å¦å·²æ»¡è¶³åœæ­¢æ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªç„¶è€Œç„¶åœ°æƒ³åˆ°ç”¨[æ ˆæ•°æ®ç»“æ„](https://en.wikipedia.org/wiki/Stack_\(abstract_data_type\))æ¥æ¨¡æ‹Ÿå‡½æ•°é€’å½’çš„è¿‡ç¨‹ã€‚

åŒæ ·åœ°ï¼Œä»¥äºŒå‰æ ‘çš„ä¸­åºéå†ä¸ºä¾‹ï¼Œæ¯ä¸€å±‚å‡½æ•°è°ƒç”¨å¤„ç†ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒåŒæ—¶è¿˜éœ€è¦ä¸€ä¸ªå˜é‡æ¥è®°å½•å½“å‰èŠ‚ç‚¹çš„å·¦å­æ ‘æ˜¯å¦å·²ç»éå†å®Œæ¯•ï¼ŒåŒæ—¶è¿™ä¸ªçŠ¶æ€å˜é‡è¿˜æ‹…è´Ÿèµ·é¿å…é‡å¤éå†åŒä¸€æ¡è·¯å¾„çš„ä½œç”¨ï¼Œä¸ºç®€å•èµ·è§ï¼Œç”¨æ•´æ•° `0` ï¼Œ `1` ï¼Œ `2` åˆ†åˆ«è¡¨ç¤ºâ€œç¬¬ä¸€æ¬¡è®¿é—®è¯¥èŠ‚ç‚¹â€ï¼Œâ€œè¯¥èŠ‚ç‚¹çš„å·¦å­æ ‘å·²ç»éå†â€ï¼Œâ€œè¯¥èŠ‚ç‚¹æœ¬èº«å·²ç»è¢«éå†â€ï¼Œæ‰€ä»¥åˆå§‹çŠ¶æ€ä¸ºï¼Œ

```python
stack = [[node, 0]]
```

ç„¶åç”¨ä¸€ä¸ª `while` å¾ªç¯æ¥æ£€æŸ¥æ ˆçš„é•¿åº¦ï¼Œåªè¦ä¸ä¸ºç©ºï¼Œè¯´æ˜æ¨¡æ‹Ÿçš„å‡½æ•°é€’å½’è°ƒç”¨è¿˜æ²¡æœ‰ç»“æŸï¼Œåœ¨æ¯ä¸€æ¬¡å¾ªç¯ä¸­ï¼ŒæŸ¥çœ‹çŠ¶æ€å˜é‡ï¼Œå¦‚æœ

- ä¸º 0 ï¼Œè¯´æ˜ç¬¬ä¸€æ¬¡è®¿é—®è¯¥èŠ‚ç‚¹ï¼Œå¦‚æœå®ƒçš„å·¦å­æ ‘ä¸ä¸ºç©ºï¼Œå°†å·¦å­æ ‘èŠ‚ç‚¹å‹æ ˆï¼Œå¹¶å°†çŠ¶æ€ç½®ä¸º 1 ï¼Œè¿™æ˜¯å› ä¸ºä¸‹ä¸€æ¬¡è®¿é—®åˆ°è¿™ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œå®ƒçš„å·¦å­æ ‘èŠ‚ç‚¹å¿…ç„¶å·²ç»å…¨éƒ¨å‡ºæ ˆï¼Œè¿™æ—¶å°±è¯¥éå†è¯¥èŠ‚ç‚¹æœ¬èº«äº†

- ä¸º 1 ï¼Œè¯´æ˜è¯¥èŠ‚ç‚¹çš„å·¦å­æ ‘éå†å·²ç»å®Œæˆï¼Œå°†å½“å‰èŠ‚ç‚¹çš„å€¼å­˜åˆ°ç»“æœåˆ—è¡¨ä¸­ï¼Œå¹¶å°†çŠ¶æ€ç½®ä¸º 2

- ä¸º 2 ï¼Œè¯´æ˜è¯¥èŠ‚ç‚¹å·²ç»è¢«éå†ï¼Œæ­¤æ—¶åº”è¯¥å°†è¯¥èŠ‚ç‚¹å‡ºæ ˆï¼Œå¦‚æœå®ƒçš„å³å­æ ‘ä¸ä¸ºç©ºçš„è¯ï¼Œå°†å…¶å³èŠ‚ç‚¹å…¥æ ˆ

è¿™æ ·å®Œæ•´çš„äºŒå‰æ ‘ä¸­åºéå†è¿­ä»£ç‰ˆä»£ç ä¸ºï¼Œ

```python
def inorder_traversal(node):
    if not node:
        # è¾¹ç¼˜æƒ…å†µæ£€æŸ¥
        return []
    output = []
    stack = [[node, 0]]
    while stack:
        node, status = stack[-1]
        if status == 0:
            stack[-1][1] = 1
            if node.left:
                stack.append([node.left, 0])
        elif status == 1:
            stack[-1][1] = 2
            output.append(node.val)
        else:
            stack.pop()
            if node.right:
                stack.append([node.right, 0])
    return output
```

è¿™æ ·çœ‹èµ·æ¥æ˜¯ä¸æ˜¯æ›´åŠ ç®€å•æ˜“æ‡‚äº†å‘¢ï¼Ÿ

# æ›´å¤šçš„ä¾‹å­

## äºŒå‰æ ‘çš„ååºéå†

æ ‘çš„ååºéå†çš„è¿­ä»£ç‰ˆæœ¬ä¸€å‘ä»¥ä»¤äººå¤´å¤§è‘—ç§°ï¼Œé…åˆä¸Š[æŸåˆ·é¢˜ç½‘ç«™çš„é¢˜è§£](https://leetcode-cn.com/problems/binary-tree-postorder-traversal/solution/er-cha-shu-de-hou-xu-bian-li-by-leetcode-solution/)ï¼Œå°±æ›´åŠ æ‰‘æœ”è¿·ç¦»äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªé—®é¢˜èƒ½ä¸èƒ½å¥—ç”¨ä¸Šè¿°è½¬æ¢â€œå…¬å¼â€å‘¢ï¼Ÿå½“ç„¶å¯ä»¥ï¼Œä½†é¦–å…ˆè¦ç¡®å®šä¸åŒçŠ¶æ€çš„å«ä¹‰ã€‚

ä¸ä¸­åºéå†ç•¥æœ‰ä¸åŒï¼Œåœ¨è¿™é‡Œç”¨æ•°å­— `0` ï¼Œ `1` ï¼Œ `2` æ¥åˆ†åˆ«è¡¨ç¤ºâ€œåˆæ¬¡è®¿é—®è¯¥èŠ‚ç‚¹â€ï¼Œâ€œå·¦å­æ ‘å·²éå†å®Œæˆâ€ï¼Œâ€œå³å­æ ‘å·²éå†å®Œæˆâ€çš„çŠ¶æ€ã€‚åœ¨æ¯ä¸€æ¬¡å¾ªç¯ä¸­ï¼ŒæŸ¥çœ‹å½“æ ˆä¸­çš„èŠ‚ç‚¹çŠ¶æ€

- ä¸º 0 ï¼Œåˆæ¬¡è®¿é—®è¯¥èŠ‚ç‚¹ï¼Œå°†çŠ¶æ€ç½®ä¸º 1 ï¼Œå¦‚æœè¯¥èŠ‚ç‚¹çš„å·¦å­æ ‘å­˜åœ¨çš„è¯ï¼Œå°†å·¦å­æ ‘å…¥æ ˆ

- ä¸º 1 ï¼Œè¯¥èŠ‚ç‚¹çš„å·¦å­æ ‘éå†å®Œæˆï¼Œå°†çŠ¶æ€ç½®ä¸º 2 ï¼Œ å¦‚æœè¯¥èŠ‚ç‚¹çš„å³å­æ ‘å­˜åœ¨çš„è¯ï¼Œå°†å³å­æ ‘å…¥æ ˆ

- ä¸º 2 ï¼Œè¯¥èŠ‚ç‚¹çš„å³å­æ ‘éå†å®Œæˆï¼Œå°†å½“å‰èŠ‚ç‚¹çš„å€¼å­˜å…¥ç»“æœåˆ—è¡¨ä¸­ï¼Œç„¶åè¯¥èŠ‚ç‚¹å‡ºæ ˆ

é€»è¾‘é¡ºåºç†æ¸…äº†ï¼Œå°±ä¸éš¾å†™å‡ºå¦‚ä¸‹ä»£ç ï¼Œ

```python
def postorder_traversal(node):
    if not node:
        # è¾¹ç¼˜æƒ…å†µæ£€æŸ¥
        return []
    output = []
    stack = [[node, 0]]
    while stack:
        node, status = stack[-1]
        if status == 0:
            stack[-1][1] = 1
            if node.left:
                stack.append([node.left, 0])
        elif status == 1:
            stack[-1][1] = 2
            if node.right:
                stack.append([node.right, 0])
        else:
            output.append(node.val)
            stack.pop()
    return output
```

## å°†åµŒå¥—åˆ—è¡¨æ‰å¹³åŒ–

ä¸ºäº†è¯´æ˜ç®€å•ï¼Œè¿™é‡Œä½¿ç”¨ä¸[æŸåˆ·é¢˜ç½‘ç«™](https://leetcode-cn.com/problems/flatten-nested-list-iterator/)ä¸ŠåŒæ ·çš„ç±»å®šä¹‰æ¥è¡¨ç¤ºåµŒå¥—åˆ—è¡¨ï¼Œå³åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æ—¢å¯ä»¥æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œè¦æ±‚å°†å…¶ä¸­æ‰€æœ‰çš„æ•´æ•°éƒ½å­˜åœ¨åˆ—è¡¨çš„ç¬¬ä¸€å±‚å¹¶è¾“å‡ºã€‚æ¯”å¦‚è¯´å¯¹äºä¸€ä¸ªåµŒå¥—åˆ—è¡¨ `[1,2,[3,4],[[5],6,[7]]]` ï¼Œå¸Œæœ›å¾—åˆ° `[1,2,3,4,5,6,7]` ã€‚

```python
class NestedInteger:
    def isInteger(self) -> bool:
        """
        @return True if this NestedInteger holds a single integer, rather than a nested list.
        """
    def getInteger(self) -> int:
        """
        @return the single integer that this NestedInteger holds, if it holds a single integer
        Return None if this NestedInteger holds a nested list
        """
    def getList(self) -> [NestedInteger]:
        """
        @return the nested list that this NestedInteger holds, if it holds a nested list
        Return None if this NestedInteger holds a single integer
        """
```

å®ƒçš„é€’å½’ç‰ˆæœ¬ä¹Ÿå¾ˆç®€å•ï¼Œé‡åˆ°æ•´æ•°å°±ç›´æ¥è¾“å‡ºï¼Œé‡åˆ°åˆ—è¡¨å°±é€’å½’è°ƒç”¨è‡ªå·±å¹¶è¿”å›ç»“æœï¼Œ

```python
def flatten_list(nested_list: [NestedInteger]):
    result = []
    def flatten(nested_list):
        for item in nested_list:
            if item.isInteger():
                result.append(item.getInteger())
            else:
                result.extend(flatten(item.getList()))
        return result
    return flatten(result)
```

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°è¯•å¥—ç”¨ä¸Šè¿°â€œå…¬å¼â€å°†å…¶è½¬æ¢ä¸ºè¿­ä»£ç‰ˆæœ¬ã€‚é¦–å…ˆï¼Œè¦æ˜ç¡®çŠ¶æ€å˜é‡çš„å«ä¹‰ï¼Œå› ä¸ºæ¯ä¸€æ¬¡çš„é€’å½’è°ƒç”¨æ˜¯ä½œç”¨åœ¨ä¸€ä¸ªåˆ—è¡¨ä¸Šçš„ï¼Œæ‰€ä»¥å½“ç”¨æ ˆæ¨¡æ‹Ÿå‡½æ•°è°ƒç”¨æ—¶ï¼ŒçŠ¶æ€å˜é‡å¯ä»¥è§„å®šä¸ºå½“å‰æ­£åœ¨å¤„ç†æ•°ç»„çš„ä¸‹æ ‡ï¼Œè¿™æ ·åˆå§‹çŠ¶æ€åˆ™ä¸º

```python
stack = [[nested_list, 0]]
```

åœ¨æ¯ä¸€æ¬¡å¾ªç¯ä¸­ï¼Œè‹¥å½“å‰å…ƒç´ ä¸ºæ•´æ•°ï¼Œå°†è¯¥æ•´æ•°å­˜åˆ°ç»“æœæ•°ç»„ä¸­ï¼Œå¹¶å°†çŠ¶æ€å˜é‡åŠ ä¸€ï¼Œä»£è¡¨ç€å½“å‰å…ƒç´ å·²ç»å¤„ç†å®Œæ¯•ï¼›å¦‚æœå½“å‰å…ƒç´ ä¸ºåˆ—è¡¨ï¼Œåˆ™å°†è¯¥åˆ—è¡¨ä¸å…¶åˆå§‹çŠ¶æ€ï¼ˆ `0` ï¼‰å…¥æ ˆï¼ŒåŒæ—¶å°†çŠ¶æ€åŠ ä¸€ï¼›å¦‚æœçŠ¶æ€è¶…å‡ºäº†åˆ—è¡¨çš„èŒƒå›´ï¼Œåˆ™ä»£è¡¨è¯¥åˆ—è¡¨å·²ç»è¢«å¤„ç†å®Œæ¯•ï¼Œå¯ä»¥å‡ºæ ˆã€‚å› æ­¤ï¼Œæœ€ç»ˆçš„ä»£ç ä¸º

```python
def flatten_list(nested_list: [NestedInteger]):
    result = []
    stack = [[nested_list, 0]]
    while stack:
        l, status = stack[-1]
        if status >= len(l):
            stack.pop()
            continue
        if l[status].isInteger():
            result.append(l[status].getInteger())
            stack[-1][1] += 1
        else:
            stack[-1][1] += 1
            stack.append([l[status].getList(), 0])
    return result
```

# 2021/10/29 æ›´æ–°

æ˜¨æ™šå†™å®Œæœ¬æ–‡ä¹‹åï¼Œä»Šæ—©æ‰å‘ç°åŸæ¥ç½‘ä¸Šå·²ç»æœ‰äº†å¾ˆå¤šæ–‡ç« ä»‹ç»ç±»ä¼¼çš„æŠ€å·§ï¼Œå…¶ä¸­ç¤ºä¾‹é—®é¢˜ã€ç¼–ç¨‹è¯­è¨€ã€å…·ä½“å®ç°æœ‰æ‰€ä¸åŒï¼Œä½†æ€æƒ³æ˜¯ä¸€è‡´çš„ï¼Œä¸ºäº†æ›´å…¨é¢çš„è®°å½•ï¼Œæˆ‘æŠŠè¿™äº›æ–‡ç« éƒ½åŠ è¿›äº†å‚è€ƒé“¾æ¥é‡ŒğŸ‘‡ğŸ»ã€‚

# å‚è€ƒé“¾æ¥

- [LeetCode äºŒå‰æ ‘ä¸­åºéå†é¢˜è§£](https://leetcode-cn.com/problems/binary-tree-inorder-traversal/solution/er-cha-shu-de-zhong-xu-bian-li-by-leetcode-solutio/)

- [LeetCode äºŒå‰æ ‘åç»­éå†é¢˜è§£](https://leetcode-cn.com/problems/binary-tree-postorder-traversal/solution/er-cha-shu-de-hou-xu-bian-li-by-leetcode-solution/)

- [Converting Recursion to Iteration](https://www.cs.odu.edu/~zeil/cs361/latest/Public/recursionConversion/index.html)
